% Chapter 5

\chapter{Conclusion \& Future Work} % Main chapter title
\label{chap:conclusions-and-future-work}

Werner Heisenberg, an eminent theoretical physicist of the $20^{th}$ century and one of the pioneers of quantum mechanics, said -
\begin{displayquote}
    "When I meet God, I am going to ask him two questions: why relativity? And why turbulence? I really believe he will have an answer for the first."
\end{displayquote}
His tongue-in-cheek quip regarding turbulence seems relevant even today, given that the comprehensive turbulence theory still eludes us. This is a testament to the complexity of dealing with turbulence from a theoretical and numerical perspective. 

Marking the culmination of this project, all of the work done so far and the conclusions drawn from the results are summarised in this chapter. It also discusses the future work that can be done to further this project's scope.
A vital component of this project involved compiling a comprehensive database of past SPH turbulence models. Each model has been listed, with their governing equations, SPH discretisations and derivation, if available. The limitations of each model have also been discussed, as well as potential areas for refinement and any advantages they provide when dealing with s specific class of problems.

Efforts to extend the EDAC scheme \parencite{Ramachandran2019} with the Lagrangian LES model is rendered challenging as detailed in \secref{sec:Extension-to-EDAC-SPH-Scheme}. The scheme also cannot make use of RANS-based models since the averaging technique assumes incompressibility, which simplifies to $(\nabla \cdot \vect{v} = 0)$, which would affect the transport equation for pressure \Eqref{eq:Ramachandran2019-edac-p-transport} which contains a term dependent of the divergence of velocity.
Therefore, a potential avenue of future work would be to consider the compressible form of EDAC \parencite{Chola2021} and develop a suitable turbulence for the scheme. This would be a fruitful endeavour since the scheme typically produces a smoother and more accurate pressure distribution for flows, confined or free, without requiring artificial viscosity. This would significantly improve the current state-of-the-art SPH schemes, which are typically plagued by spurious pressure oscillations.

The project further led to a better understanding of post-processing techniques available for SPH problems to study the effect of turbulence and the evolution of the flow fields.
Characterisation of the energy spectrum of the flow, a standard technique employed in the FEM/FVM community, had been challenging for the particle-based Lagrangian method of SPH. 
This project, through a comparative study of various interpolation techniques, kernel type, kernel radius scale, particle resolution and the amount of disorder in their spacing, allowed for appropriate recommendations to be made. This resulted in the development of a \texttt{TurbulentFlowApp} class for the \texttt{PySPH} framework, which can be used to study the energy spectrum of the flow.
Similar work was attempted to characterise the FTLE fields between two-time instances of the flow. However, the results revealed that this, at best, provides a qualitative measure of the attracting/repelling pathlines, which could only be used for visualisation purposes and possibly not for quantitative analysis. The method of using tracer particles is suggested as a potential alternative to explore in the future. They have the advantage of being able to be advected by the flow and can store the exact forces acting on them, which can be used to analyse the flow quantitatively. Other methods that track the Lagrangian coherent structures (LCS) in the flow, such as in the work of \cite{shadden2005definition}, should be explored in future.

With the post-processing aspect of the project complete, the next stage involved identifying representative schemes from each class of the five major turbulence models and implementing them in \texttt{PySPH}.
This allowed a detailed study of the performance of each of the models. Potential refinements in terms of scheme-specific parameters were also identified, along with improvements that could be made to the SPH discretisation. These results have been compiled in \tabref{tab:opt-sph-schemes}.
The comparative study involved studying the schemes at three levels of Reynolds number regimes $Re: [10^2, 10^3, 10^4]$ at multiple resolution scales. This made a study on the convergence order of these schemes possible. Furthermore, through the means of the energy spectrum, and flow field visualisation, a detailed analysis of the schemes' performance has been compiled. It was also instrumental in identifying the issues with the schemes' implementation as described solely from the literature.
This shows that reproducing a scheme's results from literature is not trivial and requires a detailed understanding of the scheme and the ability to identify the key parameters that affect the scheme's performance. This task is not made any more accessible because the codes are generally not made available, and the schemes need to be implemented in a standardised manner.
This also concerns SPH, which, unlike its typical CFD counterparts, needs more standardisation and is currently challenging to reproduce the results from the research literature. This could be a hurdle in the widespread adoption of SPH as a viable alternative to FEM/FVM, especially in turbulence modelling.

Once the schemes were optimised, the project involved a long-time simulation analysis in evaluating the performance of these schemes based on identifying potential instabilities that could creep into the flow from the building of numerical errors or issues with the physical modelling. This study simulated the TGV problem at two levels of Reynolds number regimes $Re: [10^4, 10^5]$ across two finer resolution levels $N: [100^2, 200^2]$.
The comparative study, through the use of $L_1$ and $L_{\infty}$ errors, also made use of the energy spectrums, and visualisation of flow field properties such as $\abs{\vect{v}}, P, \rho,$ and  $\vect{omega}$, to comprehensively evaluate the performance and behaviour of the schemes.
It proved crucial in demonstrating how the SPH-$\epsilon$ and $k-\epsilon$ schemes are unsuitable and must be improved before they are viable for practical use. 
On the contrary, the L-IPST-C and $\delta$-LES-SPH schemes were the most promising and could produce results that agreed with the reference solution.
The work also identified how the four schemes could be refined further to improve their convergence order and reduce the numerical errors that creep into the flow.

The inadequacies of using TGV as a benchmark problem were realised at this stage of the project, despite it serving as an excellent problem to perform OOC analysis. However,  to study the long-term behaviour of these schemes, more complex flow fields will have to be taken up as benchmark problems. It is also important to note that problems with solid boundaries will be required to evaluate these schemes in a more realistic setting. The TGV problem, being a periodic domain, did not allow for the study of boundary conditions, which are a crucial aspect of turbulence modelling.

However, the L-IPST-C and $\delta$-LES-SPH schemes were studied with the externally forced variant of the TGV problem at three levels of Reynolds number regimes $Re: [10^4, 10^5, 10^6]$, across two levels of resolution $N: [100^2, 200^2]$.
This allowed for a deeper understanding of these schemes and their ability to model the turbulent flow. Their effect on the energy spectrum, flow field, and vortical structures could be better studied in detail.
The studies also were crucial in identifying the nature and cause of the L-IPST-C scheme in over-predicting the system's energy due to the lack of a reasonable viscous dissipation mechanism. This was also the cause of the scheme's inability to redistribute the energy to the lower scales of the flow with typical cascade behaviour expected for the inertial and viscous sub-ranges. Consequently, the scheme was demonstrated to lead to a lack of total vortical structures in the flow because the particles that build up energy cannot dissipate it and move freely across the domain, leading to noisy velocity fields.
On the other hand, the $\delta$-LES-SPH scheme suffered from the opposite issue. It under-predicts the energy of the system. The viscous dissipation mechanism is overly-powerful, leading to a much steeper energy spectrum in the inertial sub-range. Therefore, the scheme should be refined to reduce this behaviour and allow for a more realistic cascade trend to form.

Such a study showed the importance of still having a periodic problem with complex yet predictable flow fields, which can be used to study how the schemes perform in the presence of $Re$-onset instabilities and how they affect the flow field. Such periodic problems would still have much insight to offer in terms of turbulence modelling while also being computationally easier to implement and solve.
This project also highlighted the current bottleneck in terms of computational speed when it comes to solving periodic problems using the \texttt{PySPH} framework. This issue does not allow the simulation to scale efficiently using more processors. The cause of this is attributed to the serial copying of data required by the particles near the boundary to enforce true periodic boundary conditions. This process is not parallelised; therefore, as the number of particles increases, the computational cost increases linearly. It was observed that typically $40-65\%$ of the run time was taken by this serial process for resolutions of $N = 100^2-200^2$. Amdahl's law states that the speedup of a program using multiple processors is limited by the time taken by the serial portion of the program. Therefore, this known issue will have to be addressed in order to scale the simulation to higher resolutions and still be able to run using a reasonable amount of time and computational resources.
Through this project, a preliminary study was performed to try and rectify this issue. It involved interpolating the properties of the particles near the boundary from the particles on the opposite side of the domain. However, early results indicated that such a technique would be bespoke to each scheme and, therefore, would not be a generalised solution. There would also present a trade-off between the computational cost of the serial process and the loss in accuracy from this interpolation method, not to mention a much higher memory requirement. This is because many more layers of ghost particles are required near the boundaries, which must be closely packed for even the most basic SPH operators to maintain still SOC.
Therefore, this issue and a suitable solution to it will have to be addressed to scale the simulation to higher resolutions which will be necessary when dealing with massive complex flow fields that exhibit isotropic turbulence.

Future work incorporating adaptive particle refinement to reduce the computational cost can also be considered, as shown in the work of \cite{Muta2022}.
However, this can be undertaken only when the scheme has been demonstrated to be robust and accurate in a standard particle setting. There could also be issues with the energy distribution across scales with adaptive refinement, which must be studied carefully.
Such a development would allow for simulations involving moving or deformable geometries, in which case the issue of the computational cost could become unfeasible. 
The work of \cite{Haftu2022} on parallel adaptive WCSPH and \cite{negi2020improved} on inlet-outlet boundary conditions would serve as a helpful junction to proceed in future.

Finally, the issue of incorporating boundary conditions and wall functions should also be addressed. This would allow for studying more complex flow fields and the effect of boundary layers which are essential when dealing with real-world problems. The work of \cite{Mayrhofer2014} on incorporating boundary conditions and wall functions for turbulence modelling would serve as a good starting point to proceed in future.
